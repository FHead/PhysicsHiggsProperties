UInt_t FindMuonEfficiencyBin( double value, double bins[], UInt_t nbins) {
  UInt_t nbinboundaries = nbins+1;
  UInt_t bin = 0;
  for (uint i=0; i < nbinboundaries; ++i) {
    if (i < nbinboundaries-1) {
      if (value >= bins[i] && value < bins[i+1]) {
        bin = i+1;
        break;
      }
    } else if (i == nbinboundaries-1) {
      if (value >= bins[i]) {
        bin = nbinboundaries;
        break;
      }
    }    
  }
  return bin;
}


Double_t GetMuonEfficiencyPtEta_8TeV(Double_t Pt, Double_t Eta) {

  Double_t ptBins[16] = {5,6,7,8,9,10,12,14,16,18,20,25,30,35,40,50};
  Double_t etaBins[17] = {0,0.2,0.4,0.6,0.8,1,1.2,1.4442,1.566,1.8,2,2.1,2.2,2.3,2.4,2.5,2.6};

// With manual corrections
  Double_t Efficiency[17][18] = {
    {0,0.00310655,0.00376616,0.00442773,0.00460216,0.00609777,0.00624254,0.00698353,0.00577092,0.00599372,0.0067733,0.00803596,0.00755214,0.00809036,0.00720825,0.000518065,0,0    },
    {0,0.79081,0.799727,0.821869,0.839758,0.839475,0.836364,0.851779,0.857797,0.884295,0.889957,0.849263,0.801925,0.718383,0.578852,0.00235174,0,0    },
    {0,0.798185,0.813868,0.821194,0.84086,0.840193,0.860549,0.865077,0.878393,0.882582,0.884576,0.86695,0.819139,0.755767,0.642021,0.00297114,0,0    },
    {0,0.818603,0.823544,0.829957,0.856189,0.853911,0.857929,0.871391,0.879998,0.87099,0.880473,0.857226,0.816761,0.77707,0.657194,0.00689198,0,0    },
    {0,0.844785,0.85652,0.862426,0.87051,0.883154,0.885467,0.882724,0.891544,0.89731,0.901019,0.869883,0.850329,0.791095,0.675151,0.00202191,0,0    },
    {0,0.864884,0.868423,0.885853,0.879464,0.892678,0.901323,0.900814,0.907389,0.909827,0.910153,0.900489,0.873202,0.824297,0.74095,0.00427069,0,0    },
    {0,0.899748,0.90273,0.901473,0.916077,0.917461,0.922043,0.921247,0.928266,0.932186,0.932596,0.929714,0.905869,0.850771,0.77638,0.00635865,0,0    },
    {0,0.913176,0.923517,0.924026,0.935773,0.932712,0.936499,0.936406,0.945602,0.948164,0.948519,0.936907,0.924398,0.885065,0.814694,0.00880694,0,0    },
    {0,0.938205,0.935037,0.942054,0.945271,0.938845,0.945369,0.94818,0.951941,0.953122,0.959868,0.949132,0.937199,0.908581,0.857262,0.00651605,0,0    },
    {0,0.943991,0.945746,0.950374,0.950843,0.952598,0.953318,0.955402,0.957979,0.961,0.963173,0.958725,0.94898,0.922178,0.865236,0.00733988,0,0    },
    {0,0.951185,0.955679,0.956763,0.95545,0.956241,0.958642,0.960313,0.964707,0.96718,0.966832,0.965252,0.949272,0.93776,0.893001,0.00580332,0,0    },
    {0,0.950236,0.951173,0.953432,0.956132,0.954751,0.955091,0.956232,0.962074,0.960141,0.965906,0.960336,0.949169,0.939457,0.908669,0.00852713,0,0    },
    {0,0.957911,0.95772,0.960108,0.96135,0.96242,0.962072,0.960435,0.963349,0.965235,0.967116,0.966238,0.959255,0.950209,0.931981,0.0122542,0,0    },
    {0,0.962815,0.963788,0.96662,0.967082,0.967496,0.967654,0.965408,0.96831,0.969698,0.970974,0.971376,0.965849,0.956838,0.941952,0.0137029,0,0    },
    {0,0.969177,0.971359,0.969926,0.970385,0.970631,0.968544,0.968582,0.971928,0.972583,0.974459,0.971142,0.967553,0.957586,0.94859,0.00880902,0,0    },
    {0,0.956886,0.956622,0.959032,0.95875,0.957539,0.958023,0.954711,0.958679,0.959045,0.961807,0.957473,0.955189,0.95201,0.938766,0.00813665,0,0    },
    {0,0.958114,0.959787,0.961188,0.961276,0.960797,0.960194,0.956426,0.960943,0.959582,0.96318,0.958689,0.955747,0.950968,0.937852,0.00817563,0,0}
  };

// Without manual corrections
//   Double_t Efficiency[17][18] = {
//     {0,0.00270135,0.00327492,0.0038502,0.00400188,0.00530241,0.00542829,0.00607264,0.00501819,0.00521193,0.00588983,0.00698779,0.00656708,0.0070351,0.00626804,0.000450491,0,0    },
//     {0,0.687661,0.695415,0.714669,0.730224,0.729978,0.727273,0.740677,0.745911,0.768952,0.773876,0.73849,0.697326,0.624681,0.503349,0.00204499,0,0    },
//     {0,0.760176,0.775113,0.782089,0.800819,0.800184,0.819571,0.823883,0.836565,0.840554,0.842454,0.825667,0.780132,0.719778,0.611449,0.00282965,0,0    },
//     {0,0.806505,0.811373,0.817692,0.843536,0.841291,0.84525,0.858513,0.866993,0.858119,0.867461,0.844557,0.804691,0.765586,0.647482,0.00679012,0,0    },
//     {0,0.8323,0.843862,0.849681,0.857645,0.870102,0.872382,0.869679,0.878368,0.88405,0.887704,0.857027,0.837762,0.779404,0.665174,0.00199203,0,0    },
//     {0,0.852102,0.855589,0.872762,0.866467,0.879486,0.888003,0.887502,0.893979,0.896382,0.896702,0.887182,0.860298,0.812115,0.73,0.00420757,0,0    },
//     {0,0.886452,0.889389,0.88815,0.902539,0.903902,0.908416,0.907633,0.914548,0.91841,0.918814,0.915974,0.892482,0.838198,0.764906,0.00626468,0,0    },
//     {0,0.899681,0.909869,0.91037,0.921944,0.918928,0.922659,0.922568,0.931627,0.934152,0.934501,0.923061,0.910737,0.871986,0.802654,0.00867679,0,0    },
//     {0,0.92434,0.921218,0.928132,0.931302,0.92497,0.931398,0.934167,0.937873,0.939037,0.945682,0.935106,0.923349,0.895153,0.844593,0.00641975,0,0    },
//     {0,0.930041,0.93177,0.936329,0.936791,0.93852,0.939229,0.941283,0.943822,0.946798,0.948939,0.944556,0.934955,0.90855,0.852449,0.0072314,0,0    },
//     {0,0.937128,0.941556,0.942624,0.94133,0.942109,0.944475,0.946121,0.95045,0.952886,0.952544,0.950987,0.935243,0.923902,0.879804,0.00571755,0,0    },
//     {0,0.950236,0.951173,0.953432,0.956132,0.954751,0.955091,0.956232,0.962074,0.960141,0.965906,0.960336,0.949169,0.939457,0.908669,0.00852713,0,0    },
//     {0,0.957911,0.95772,0.960108,0.96135,0.96242,0.962072,0.960435,0.963349,0.965235,0.967116,0.966238,0.959255,0.950209,0.931981,0.0122542,0,0    },
//     {0,0.962815,0.963788,0.96662,0.967082,0.967496,0.967654,0.965408,0.96831,0.969698,0.970974,0.971376,0.965849,0.956838,0.941952,0.0137029,0,0    },
//     {0,0.969177,0.971359,0.969926,0.970385,0.970631,0.968544,0.968582,0.971928,0.972583,0.974459,0.971142,0.967553,0.957586,0.94859,0.00880902,0,0    },
//     {0,0.971458,0.97119,0.973637,0.97335,0.972121,0.972612,0.969249,0.973278,0.973649,0.976454,0.972054,0.969735,0.966508,0.953062,0.00826056,0,0    },
//     {0,0.972705,0.974403,0.975825,0.975915,0.975429,0.974817,0.970991,0.975577,0.974195,0.977848,0.973288,0.970302,0.96545,0.952134,0.00830013,0,0}
//   };


  Int_t tmpPtBin = FindMuonEfficiencyBin( Pt , ptBins, 15);
  Int_t tmpEtaBin = FindMuonEfficiencyBin( Eta , etaBins, 16);
  return Efficiency[tmpPtBin][tmpEtaBin];
}


Double_t GetMuonEfficiencyPtEta_7TeV(Double_t Pt, Double_t Eta) {

  Double_t ptBins[16] = {5,6,7,8,9,10,12,14,16,18,20,25,30,35,40,50};
  Double_t etaBins[17] = {0,0.2,0.4,0.6,0.8,1,1.2,1.4442,1.566,1.8,2,2.1,2.2,2.3,2.4,2.5,2.6};


  Double_t Efficiency[17][18] = {
    {0,0.00308032,0.00373405,0.00392678,0.00430705,0.00557366,0.00609938,0.00650987,0.00690435,0.0056104,0.00696894,0.00735301,0.00814747,0.00850875,0.00838531,0.000132112,0,0    },
    {0,0.989117,0.982621,0.998337,0.995139,0.981931,0.96267,0.969296,0.964748,0.963238,0.956427,0.942661,0.913775,0.892728,0.86037,0.00473898,0,0    },
    {0,0.973865,0.972673,0.979222,0.974445,0.971328,0.965924,0.968542,0.971856,0.962549,0.957505,0.947008,0.933,0.921316,0.892736,0.00470128,0,0    },
    {0,0.964512,0.961528,0.964137,0.96447,0.95993,0.955325,0.957127,0.956622,0.951303,0.948962,0.951898,0.928435,0.928898,0.890552,0.00436928,0,0    },
    {0,0.974,0.968982,0.979639,0.978145,0.973824,0.971907,0.972043,0.971138,0.96701,0.966167,0.958871,0.941526,0.944304,0.911298,0.00574991,0,0    },
    {0,0.984436,0.979718,0.986657,0.983971,0.981916,0.981616,0.979704,0.979747,0.97668,0.975863,0.973874,0.946995,0.956307,0.92163,0.00530954,0,0    },
    {0,0.989381,0.983589,0.98899,0.989762,0.987923,0.98373,0.984692,0.987418,0.981448,0.985082,0.980811,0.960183,0.964758,0.930456,0.00353783,0,0    },
    {0,0.99275,0.990852,0.993813,0.99258,0.991728,0.989244,0.986461,0.993198,0.986664,0.987551,0.980691,0.972511,0.969371,0.940997,0.00495779,0,0    },
    {0,0.994929,0.991387,0.995427,0.995427,0.992313,0.992582,0.9917,0.991049,0.988354,0.991207,0.990418,0.970859,0.972235,0.947682,0.00489956,0,0    },
    {0,0.995775,0.993359,0.995477,0.99617,0.993696,0.992297,0.992576,0.989968,0.987674,0.99215,0.987572,0.971982,0.977948,0.943492,0.00311475,0,0    },
    {0,0.99463,0.992808,0.995142,0.994988,0.994068,0.990083,0.990702,0.98871,0.990719,0.989209,0.985946,0.972166,0.975923,0.947616,0.00395837,0,0    },
    {0,0.982066,0.979152,0.981753,0.981641,0.979548,0.977333,0.977804,0.977659,0.975142,0.978286,0.974802,0.960182,0.961575,0.928187,0.00451371,0,0    },
    {0,0.982921,0.981385,0.983238,0.982676,0.979615,0.978958,0.976741,0.978982,0.975406,0.97738,0.972193,0.959191,0.961615,0.934375,0.00387967,0,0    },
    {0,0.983996,0.9808,0.985112,0.983017,0.982316,0.981151,0.980523,0.979132,0.975346,0.978828,0.973992,0.960269,0.958243,0.925804,0.00436324,0,0    },
    {0,0.984703,0.984105,0.985548,0.983718,0.982999,0.981955,0.979824,0.981884,0.977266,0.979787,0.975021,0.962419,0.96068,0.921787,0.00382268,0,0    },
    {0,0.971527,0.969163,0.972183,0.971849,0.971139,0.968209,0.966139,0.968394,0.964762,0.966887,0.962825,0.95232,0.947936,0.911554,0.00480162,0,0    },
    {0,0.97549,0.973437,0.975662,0.97609,0.97462,0.973699,0.971274,0.971915,0.966594,0.970766,0.967143,0.956394,0.958897,0.928685,0.0046282,0,0}
  };



  Int_t tmpPtBin = FindMuonEfficiencyBin( Pt , ptBins, 15);
  Int_t tmpEtaBin = FindMuonEfficiencyBin( Eta , etaBins, 16);
  return Efficiency[tmpPtBin][tmpEtaBin];
}
